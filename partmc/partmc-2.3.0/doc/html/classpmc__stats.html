<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PartMC: pmc_stats Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PartMC
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="modulepmc__stats-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pmc_stats Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <code><a class="el" href="structpmc__stats_1_1stats__t.html" title="Structure for online computation of mean and variance. ">stats_t</a></code> type and associated subroutines.  
 <a href="classpmc__stats.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for online computation of 1D arrays of mean and variance.  <a href="structpmc__stats_1_1stats__1d__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for online computation of 2D arrays of mean and variance.  <a href="structpmc__stats_1_1stats__2d__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpmc__stats_1_1stats__t.html">stats_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for online computation of mean and variance.  <a href="structpmc__stats_1_1stats__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac5750dcd5d754124f53223d4072344c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#ac5750dcd5d754124f53223d4072344c1">stats_clear</a> (stats)</td></tr>
<tr class="memdesc:ac5750dcd5d754124f53223d4072344c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear data statistics collected so far.  <a href="#ac5750dcd5d754124f53223d4072344c1">More...</a><br /></td></tr>
<tr class="separator:ac5750dcd5d754124f53223d4072344c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0cd9c69e90ebd760939ce802a889f94"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#ac0cd9c69e90ebd760939ce802a889f94">stats_1d_clear</a> (stats)</td></tr>
<tr class="memdesc:ac0cd9c69e90ebd760939ce802a889f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear data statistics collected so far.  <a href="#ac0cd9c69e90ebd760939ce802a889f94">More...</a><br /></td></tr>
<tr class="separator:ac0cd9c69e90ebd760939ce802a889f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4416bf7fadf595f6954554bcda94f144"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a4416bf7fadf595f6954554bcda94f144">stats_2d_clear</a> (stats)</td></tr>
<tr class="memdesc:a4416bf7fadf595f6954554bcda94f144"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear data statistics collected so far.  <a href="#a4416bf7fadf595f6954554bcda94f144">More...</a><br /></td></tr>
<tr class="separator:a4416bf7fadf595f6954554bcda94f144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e09f5a5169acdc4fbeb28b83586fa5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a09e09f5a5169acdc4fbeb28b83586fa5">stats_add</a> (stats, data)</td></tr>
<tr class="memdesc:a09e09f5a5169acdc4fbeb28b83586fa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new data value to a <code><a class="el" href="structpmc__stats_1_1stats__t.html" title="Structure for online computation of mean and variance. ">stats_t</a></code> structure.  <a href="#a09e09f5a5169acdc4fbeb28b83586fa5">More...</a><br /></td></tr>
<tr class="separator:a09e09f5a5169acdc4fbeb28b83586fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39445eed819e5c2e7fdd867855e23fc6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a39445eed819e5c2e7fdd867855e23fc6">stats_1d_add</a> (stats, data)</td></tr>
<tr class="memdesc:a39445eed819e5c2e7fdd867855e23fc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add all new data values to a <code><a class="el" href="structpmc__stats_1_1stats__1d__t.html" title="Structure for online computation of 1D arrays of mean and variance. ">stats_1d_t</a></code> structure.  <a href="#a39445eed819e5c2e7fdd867855e23fc6">More...</a><br /></td></tr>
<tr class="separator:a39445eed819e5c2e7fdd867855e23fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e469252e2fa292137c09f0a86fcafc7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a4e469252e2fa292137c09f0a86fcafc7">stats_1d_add_entry</a> (stats, data, i)</td></tr>
<tr class="memdesc:a4e469252e2fa292137c09f0a86fcafc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new single data value to a <code><a class="el" href="structpmc__stats_1_1stats__1d__t.html" title="Structure for online computation of 1D arrays of mean and variance. ">stats_1d_t</a></code> structure.  <a href="#a4e469252e2fa292137c09f0a86fcafc7">More...</a><br /></td></tr>
<tr class="separator:a4e469252e2fa292137c09f0a86fcafc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf44b0b2ca237de63a455f077ad5c51e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#adf44b0b2ca237de63a455f077ad5c51e">stats_2d_add</a> (stats, data)</td></tr>
<tr class="memdesc:adf44b0b2ca237de63a455f077ad5c51e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add all new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure.  <a href="#adf44b0b2ca237de63a455f077ad5c51e">More...</a><br /></td></tr>
<tr class="separator:adf44b0b2ca237de63a455f077ad5c51e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130511c11730c58ad4e4a75eece0330b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a130511c11730c58ad4e4a75eece0330b">stats_2d_add_row</a> (stats, data, i)</td></tr>
<tr class="memdesc:a130511c11730c58ad4e4a75eece0330b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a row of new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure.  <a href="#a130511c11730c58ad4e4a75eece0330b">More...</a><br /></td></tr>
<tr class="separator:a130511c11730c58ad4e4a75eece0330b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4adead65ab33601c8d28a1edb89755"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a3d4adead65ab33601c8d28a1edb89755">stats_2d_add_col</a> (stats, data, j)</td></tr>
<tr class="memdesc:a3d4adead65ab33601c8d28a1edb89755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a column of new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure.  <a href="#a3d4adead65ab33601c8d28a1edb89755">More...</a><br /></td></tr>
<tr class="separator:a3d4adead65ab33601c8d28a1edb89755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab357ab9aa317d0059079eb870bfc17eb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#ab357ab9aa317d0059079eb870bfc17eb">stats_2d_add_entry</a> (stats, data, i, j)</td></tr>
<tr class="memdesc:ab357ab9aa317d0059079eb870bfc17eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a single new data value to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure.  <a href="#ab357ab9aa317d0059079eb870bfc17eb">More...</a><br /></td></tr>
<tr class="separator:ab357ab9aa317d0059079eb870bfc17eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cecea8dc7d64a4b8800f09e7bc2d54f"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a9cecea8dc7d64a4b8800f09e7bc2d54f">stats_conf_95_offset</a> (stats)</td></tr>
<tr class="memdesc:a9cecea8dc7d64a4b8800f09e7bc2d54f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the 95% confidence interval offset from the mean.  <a href="#a9cecea8dc7d64a4b8800f09e7bc2d54f">More...</a><br /></td></tr>
<tr class="separator:a9cecea8dc7d64a4b8800f09e7bc2d54f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0f22506fbe1564d5dfe9b348967e3f"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(size(stats%n))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#abb0f22506fbe1564d5dfe9b348967e3f">stats_1d_conf_95_offset</a> (stats)</td></tr>
<tr class="memdesc:abb0f22506fbe1564d5dfe9b348967e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the 95% confidence interval offset from the mean.  <a href="#abb0f22506fbe1564d5dfe9b348967e3f">More...</a><br /></td></tr>
<tr class="separator:abb0f22506fbe1564d5dfe9b348967e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b54545fdbc6ea7302c947217f65a3cf"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(size(stats%n, <br class="typebreak" />
1),size(stats%n, 2))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a4b54545fdbc6ea7302c947217f65a3cf">stats_2d_conf_95_offset</a> (stats)</td></tr>
<tr class="memdesc:a4b54545fdbc6ea7302c947217f65a3cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the 95% confidence interval offset from the mean.  <a href="#a4b54545fdbc6ea7302c947217f65a3cf">More...</a><br /></td></tr>
<tr class="separator:a4b54545fdbc6ea7302c947217f65a3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03fc23e0f58ef39a98b3fab675f7ec2f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a03fc23e0f58ef39a98b3fab675f7ec2f">update_mean_var</a> (mean, var, data, n)</td></tr>
<tr class="memdesc:a03fc23e0f58ef39a98b3fab675f7ec2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute a running average and variance.  <a href="#a03fc23e0f58ef39a98b3fab675f7ec2f">More...</a><br /></td></tr>
<tr class="separator:a03fc23e0f58ef39a98b3fab675f7ec2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b9373973781e467921c5e7558a57f9"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a60b9373973781e467921c5e7558a57f9">student_t_95_coeff</a> (n_sample)</td></tr>
<tr class="memdesc:a60b9373973781e467921c5e7558a57f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a fairly tight upper-bound on the Student's t coefficient for the 95% confidence interval.  <a href="#a60b9373973781e467921c5e7558a57f9">More...</a><br /></td></tr>
<tr class="separator:a60b9373973781e467921c5e7558a57f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef20f4ac022e62933d3ed80e4041b88"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a4ef20f4ac022e62933d3ed80e4041b88">conf_95_offset</a> (var, n_sample)</td></tr>
<tr class="memdesc:a4ef20f4ac022e62933d3ed80e4041b88"><td class="mdescLeft">&#160;</td><td class="mdescRight">95% confidence interval offset from mean.  <a href="#a4ef20f4ac022e62933d3ed80e4041b88">More...</a><br /></td></tr>
<tr class="separator:a4ef20f4ac022e62933d3ed80e4041b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bd7c2f154323bb763f7bfa0f6e6f9a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a7bd7c2f154323bb763f7bfa0f6e6f9a1">stats_output_netcdf</a> (stats, ncid, name, unit)</td></tr>
<tr class="memdesc:a7bd7c2f154323bb763f7bfa0f6e6f9a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write statistics (mean and 95% conf. int.) to a NetCDF file.  <a href="#a7bd7c2f154323bb763f7bfa0f6e6f9a1">More...</a><br /></td></tr>
<tr class="separator:a7bd7c2f154323bb763f7bfa0f6e6f9a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644ef48950c748f3ab3a3d9276186c21"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#a644ef48950c748f3ab3a3d9276186c21">stats_1d_output_netcdf</a> (stats, ncid, name, dim_name, unit)</td></tr>
<tr class="memdesc:a644ef48950c748f3ab3a3d9276186c21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write statistics (mean and 95% conf. int.) to a NetCDF file.  <a href="#a644ef48950c748f3ab3a3d9276186c21">More...</a><br /></td></tr>
<tr class="separator:a644ef48950c748f3ab3a3d9276186c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17733f0597dca5b088f1f4b6d99ded8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__stats.html#ad17733f0597dca5b088f1f4b6d99ded8">stats_2d_output_netcdf</a> (stats, ncid, name, dim_name_1, dim_name_2, unit)</td></tr>
<tr class="memdesc:ad17733f0597dca5b088f1f4b6d99ded8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write statistics (mean and 95% conf. int.) to a NetCDF file.  <a href="#ad17733f0597dca5b088f1f4b6d99ded8">More...</a><br /></td></tr>
<tr class="separator:ad17733f0597dca5b088f1f4b6d99ded8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <code><a class="el" href="structpmc__stats_1_1stats__t.html" title="Structure for online computation of mean and variance. ">stats_t</a></code> type and associated subroutines. </p>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00009">9</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a4ef20f4ac022e62933d3ed80e4041b88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function pmc_stats::conf_95_offset </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_sample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>95% confidence interval offset from mean. </p>
<p>If <code>mean</code> and <code>var</code> are the sample mean and sample variance of <code>n</code> data values, then </p><pre>
 offset = conf_95_offset(var, n)
 </pre><p> means that the 95% confidence interval for the mean is <code>[mean - offset, mean + offset]</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">var</td><td>Sample variance of data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_sample</td><td>Number of samples. </td></tr>
  </table>
  </dd>
</dl>
<p>Return offset from mean for the 95% confidence interval. </p>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00549">549</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a39445eed819e5c2e7fdd867855e23fc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_1d_add </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add all new data values to a <code><a class="el" href="structpmc__stats_1_1stats__1d__t.html" title="Structure for online computation of 1D arrays of mean and variance. ">stats_1d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data values to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00108">108</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a4e469252e2fa292137c09f0a86fcafc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_1d_add_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new single data value to a <code><a class="el" href="structpmc__stats_1_1stats__1d__t.html" title="Structure for online computation of 1D arrays of mean and variance. ">stats_1d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data value to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Index of data value to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00140">140</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ac0cd9c69e90ebd760939ce802a889f94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_1d_clear </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear data statistics collected so far. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to clear. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00061">61</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="abb0f22506fbe1564d5dfe9b348967e3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(size(stats%n)) pmc_stats::stats_1d_conf_95_offset </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the 95% confidence interval offset from the mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to find confidence interval for. </td></tr>
  </table>
  </dd>
</dl>
<p>Return offset so that [mean - offset, mean + offset] is the 95% confidence interval. </p>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00315">315</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a644ef48950c748f3ab3a3d9276186c21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_1d_output_netcdf </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__1d__t.html">stats_1d_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>dim_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>unit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write statistics (mean and 95% conf. int.) to a NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to write.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Variable name in NetCDF file.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim_name</td><td>NetCDF dimension name for the variable.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unit</td><td>Unit of variable. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00587">587</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="adf44b0b2ca237de63a455f077ad5c51e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_add </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:, :), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add all new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data values to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00162">162</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a3d4adead65ab33601c8d28a1edb89755"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_add_col </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a column of new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data values to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Column of data value to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00235">235</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ab357ab9aa317d0059079eb870bfc17eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_add_entry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a single new data value to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data values to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>First index of data value to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Second index of data value to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00273">273</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a130511c11730c58ad4e4a75eece0330b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_add_row </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a row of new data values to a <code><a class="el" href="structpmc__stats_1_1stats__2d__t.html" title="Structure for online computation of 2D arrays of mean and variance. ">stats_2d_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data values to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Row of data value to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00197">197</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a4416bf7fadf595f6954554bcda94f144"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_clear </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear data statistics collected so far. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to clear. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00077">77</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a4b54545fdbc6ea7302c947217f65a3cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(size(stats%n, 1),          size(stats%n, 2)) pmc_stats::stats_2d_conf_95_offset </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the 95% confidence interval offset from the mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to find confidence interval for. </td></tr>
  </table>
  </dd>
</dl>
<p>Return offset so that [mean - offset, mean + offset] is the 95% confidence interval. </p>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00335">335</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ad17733f0597dca5b088f1f4b6d99ded8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_2d_output_netcdf </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__2d__t.html">stats_2d_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>dim_name_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>dim_name_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>unit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write statistics (mean and 95% conf. int.) to a NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to write.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Variable name in NetCDF file.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim_name_1</td><td>First NetCDF dimension name for the variable.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim_name_2</td><td>Second NetCDF dimension name for the variable.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unit</td><td>Unit of variable. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00610">610</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a09e09f5a5169acdc4fbeb28b83586fa5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_add </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__t.html">stats_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new data value to a <code><a class="el" href="structpmc__stats_1_1stats__t.html" title="Structure for online computation of mean and variance. ">stats_t</a></code> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data value to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00093">93</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ac5750dcd5d754124f53223d4072344c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_clear </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__t.html">stats_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear data statistics collected so far. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stats</td><td>Statistics structure to clear. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00049">49</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a9cecea8dc7d64a4b8800f09e7bc2d54f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function pmc_stats::stats_conf_95_offset </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__t.html">stats_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the 95% confidence interval offset from the mean. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to find confidence interval for. </td></tr>
  </table>
  </dd>
</dl>
<p>Return offset so that [mean - offset, mean + offset] is the 95% confidence interval. </p>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00299">299</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7bd7c2f154323bb763f7bfa0f6e6f9a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::stats_output_netcdf </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__stats_1_1stats__t.html">stats_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>unit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write statistics (mean and 95% conf. int.) to a NetCDF file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>Statistics structure to write.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Variable name in NetCDF file.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unit</td><td>Unit of variable. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00567">567</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a60b9373973781e467921c5e7558a57f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function pmc_stats::student_t_95_coeff </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a fairly tight upper-bound on the Student's t coefficient for the 95% confidence interval. </p>
<p>The number of degrees of freedom is one less than <code>n_sample</code>. If a set of <img class="formulaInl" alt="$n$" src="form_161.png"/> numbers has sample mean <img class="formulaInl" alt="$\mu$" src="form_178.png"/> and sample standard deviation <img class="formulaInl" alt="$\sigma$" src="form_179.png"/>, then the 95% confidence interval for the mean is <img class="formulaInl" alt="$[\mu - r\sigma/\sqrt{n}, \mu + r\sigma/\sqrt{n}]$" src="form_180.png"/>, where <code>r = student_t_95_coeff(n_sample)</code>.</p>
<p>The method used here was written by MW on 2011-05-01, based on the following empirical observation. If <img class="formulaInl" alt="$f(\nu) = t_{0.95,\nu}$" src="form_181.png"/> is the function we want, where <img class="formulaInl" alt="$\nu = n - 1$" src="form_182.png"/> is the number of degrees-of-freedom, then set <img class="formulaInl" alt="$g(\nu) = f(\nu) - L$" src="form_183.png"/>, where <img class="formulaInl" alt="$L = \Phi^{-1}(0.975)$" src="form_184.png"/> is the limiting value given by the Gaussian CDF <img class="formulaInl" alt="$\Phi$" src="form_185.png"/>. We observe numerically that <img class="formulaInl" alt="$g'(\nu) < -1$" src="form_186.png"/> and <img class="formulaInl" alt="$g'(\nu) \to -1$" src="form_187.png"/> as <img class="formulaInl" alt="$\nu \to \infty$" src="form_188.png"/>. Thus <img class="formulaInl" alt="$g(\nu)$" src="form_189.png"/> is well-approximated by <img class="formulaInl" alt="$A/\nu$" src="form_190.png"/> for some <img class="formulaInl" alt="$A$" src="form_111.png"/>. Furthermore, if <img class="formulaInl" alt="$g(\nu^*) = A^*/\nu$" src="form_191.png"/>, then <img class="formulaInl" alt="$g(\nu) < A^*/\nu$" src="form_192.png"/> for <img class="formulaInl" alt="$\nu > \nu^*$" src="form_193.png"/>. We thus have <img class="formulaInl" alt="$f(\nu) \le (f(\nu^*) - L) (\nu^* / \nu) + L$" src="form_194.png"/> for <img class="formulaInl" alt="$\nu \ge \nu^*$" src="form_195.png"/>. By using a sequence of known <img class="formulaInl" alt="$(\nu^*, f(\nu^*))$" src="form_196.png"/> pairs we can thus construct a fairly tight upper bound.</p>
<p>This implementation has an error of below 0.1% for all values of <code>n_sample</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_sample</td><td>Number of samples. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00510">510</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a03fc23e0f58ef39a98b3fab675f7ec2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_stats::update_mean_var </td>
          <td>(</td>
          <td class="paramtype">real(kind=dp), intent(inout)&#160;</td>
          <td class="paramname"><em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(inout)&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute a running average and variance. </p>
<p>Given a sequence of data <code>x(i)</code> for <code>i = 1,...,n</code>, this should be called like </p><pre>
 do i = 1,n
   call update_mean_var(mean, var, x(i), i)
 end do
 </pre><p> After each call the variables <code>mean</code> and <code>var</code> will be the sample mean and sample variance of the sequence elements up to <code>i</code>.</p>
<p>This computes the sample mean and sample variance using a recurrence. The initial sample mean is <img class="formulaInl" alt="$m_1 = x_1$" src="form_152.png"/> and the initial sample variance is <img class="formulaInl" alt="$v_1 = 0$" src="form_153.png"/> for <img class="formulaInl" alt="$n = 1$" src="form_154.png"/>, and then for <img class="formulaInl" alt="$n \ge 2$" src="form_155.png"/> we use the mean update </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ m_n = m_{n-1} + \frac{x_n - m_{n-1}}{n} \]" src="form_156.png"/>
</p>
<p> and the variance update </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_n = \frac{n - 2}{n - 1} v_{n-1} + \frac{(x_n - m_{n-1})^2}{n}. \]" src="form_157.png"/>
</p>
<p> Then <img class="formulaInl" alt="$m_n$" src="form_158.png"/> and <img class="formulaInl" alt="$v_n$" src="form_159.png"/> are the sample mean and sample variance for <img class="formulaInl" alt="$\{x_1,\ldots,x_n\}$" src="form_160.png"/> for each <img class="formulaInl" alt="$n$" src="form_161.png"/>.</p>
<p>The derivation of these formulas begins with the definitions for the running total </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ t_n = \sum_{i=1}^n x_i \]" src="form_162.png"/>
</p>
<p> and running sum of square differences </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ s_n = \sum_{i=1}^n (x_i - m_n)^2. \]" src="form_163.png"/>
</p>
<p> Then the running mean is <img class="formulaInl" alt="$m_n = \frac{t_n}{n}$" src="form_164.png"/>, the running population variance is <img class="formulaInl" alt="$p_n = \frac{1}{n} \left( s_n - n m_n^2 \right)$" src="form_165.png"/>, and the running sample variance <img class="formulaInl" alt="$v_n = \frac{1}{n - 1} \left( s_n - n m_n^2 \right)$" src="form_166.png"/>.</p>
<p>We can then compute the mean update above, and observing that </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ s_n = \sum_{i=1}^n x_i^2 - n m_n^2 \]" src="form_167.png"/>
</p>
<p> we can compute the sum-of-square-dfferences update identity </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ s_n = s_{n-1} + \frac{n - 1}{n} (x_n - m_{n-1})^2. \]" src="form_168.png"/>
</p>
<p> The algorithm then follows immediately. The population variance update is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_n = \frac{n-1}{n} p_{n-1} + \frac{(x_n - m_n)(x_n - m_{n-1})}{n} = \frac{n-1}{n} p_{n-1} + \frac{n-1}{n^2} (x_n - m_{n-1})^2. \]" src="form_169.png"/>
</p>
<p>This algorithm (in a form where <img class="formulaInl" alt="$m_n$" src="form_158.png"/> and <img class="formulaInl" alt="$s_n$" src="form_170.png"/> are tracked) originally appeared in:</p>
<p>B. P. Welford [1962] "Note on a Method for Calculating Corrected
 Sums of Squares and Products", Technometrics 4(3), 419-420.</p>
<p>Numerical tests performed by M. West on 2012-04-12 seem to indicate that there is no substantial difference between tracking <img class="formulaInl" alt="$s_n$" src="form_170.png"/> versus <img class="formulaInl" alt="$v_n$" src="form_159.png"/>.</p>
<p>The same method (tracking <img class="formulaInl" alt="$m_n$" src="form_158.png"/> and <img class="formulaInl" alt="$s_n$" src="form_170.png"/>) is presented on page 232 in Section 4.2.2 of Knuth:</p>
<p>D. E. Knuth [1988] "The Art of Computer Programming, Volume 2:
 Seminumerical Algorithms", third edition, Addison Wesley Longman, ISBN 0-201-89684-2.</p>
<p>An analysis of the error introduced by different variance computation methods is given in:</p>
<p>T. F. Chan, G. H. Golub, and R. J. LeVeque [1983] "Algorithms for
 Computing the Sample Variance: Analysis and Recommendations", The American Statistician 37(3), 242-247.</p>
<p>The relative error in <img class="formulaInl" alt="$s_n$" src="form_170.png"/> of Welford's method (tracking <img class="formulaInl" alt="$m_n$" src="form_158.png"/> and <img class="formulaInl" alt="$s_n$" src="form_170.png"/>) is of order <img class="formulaInl" alt="$n \kappa \epsilon$" src="form_171.png"/>, where <img class="formulaInl" alt="$\epsilon$" src="form_172.png"/> is the machine precision and <img class="formulaInl" alt="$\kappa$" src="form_173.png"/> is the condition number for the problem, which is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \kappa = \frac{\|x\|_2}{\sqrt{s_n}} = \sqrt{1 + \frac{m_n^2}{p_n}} \approx \frac{m_n}{p_n}. \]" src="form_174.png"/>
</p>
<p>This analysis was apparently first given in:</p>
<p>T. F. C. Chan and J. G. Lewis [1978] "Rounding error analysis of
 algorithms for computing means and standard deviations", Technical Report No. 284, The Johns Hopkins University, Department of Mathematical Sciences.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mean</td><td>Mean value to update (on entry <img class="formulaInl" alt="$m_{n-1}$" src="form_175.png"/>, on exit <img class="formulaInl" alt="$m_n$" src="form_158.png"/>).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">var</td><td>Variance value to update (on entry <img class="formulaInl" alt="$v_{n-1}$" src="form_176.png"/>, on exit <img class="formulaInl" alt="$v_n$" src="form_159.png"/>).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data value <img class="formulaInl" alt="$x_n$" src="form_177.png"/>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number <img class="formulaInl" alt="$n$" src="form_161.png"/> of this data value. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stats_8_f90_source.html#l00455">455</a> of file <a class="el" href="stats_8_f90_source.html">stats.F90</a>.</p>

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li><a class="el" href="stats_8_f90_source.html">stats.F90</a></li>
</ul>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
PartMC 2.3.0 documentation generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.7</small></address>
</body>
</html>
