<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PartMC: Coding Style</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PartMC
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PartMC Code Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Coding Style </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The code is mainly Fortran 90, with a few parts still clearly showing their Fortran 77 heritage. A few Fortran 95 and Fortran 2003 features are used (mainly the <code>COMMAND_ARGUMENT_COUNT</code> and <code>GET_COMMAND_ARGUMENT</code> intrinsics). The code needs to be processed with <code>cpp</code> or a compatible pre-processor.</p>
<h1><a class="anchor" id="oo_fortran"></a>
Object Oriented Fortran</h1>
<p>Extensive use is made of Fortran 90 derived types and pointers for dynamic memory allocation of arrays inside derived types. Derived types are named <code>my_type_t</code> and are generally defined in modules named <code>pmc_my_type</code> within files named <code>my_type.F95</code>. Each derived type has allocation and deallocation functions <code>my_type_allocate()</code> and <code>my_type_deallocate()</code>, where appropriate. Almost all subroutines and function in each <code>my_type.F95</code> file have names of the form <code>my_type_*</code>() and take an object of type <code>my_type_t</code> (called <code>my_type</code>) as the first argument on which to operate.</p>
<p>Module names are always the same as the name of the containing file, but prefixed with <code>pmc_</code>. Thus the module <code><a class="el" href="classpmc__condense.html" title="Water condensation onto aerosol particles. ">pmc_condense</a></code> is contained in the file <code>condense.F95</code>.</p>
<h1><a class="anchor" id="mem_manage"></a>
Memory Management</h1>
<p>The memory allocation policy is that all functions must be called with an already allocated structure. That is, if a subroutine defines a variable of type <code>my_type_t</code>, then it must call <code>my_type_allocate()</code> or <code>my_type_allocate_size()</code> on it before passing it to any other subroutines or functions. The defining subroutine is also responsible for calling <code>my_type_deallocate()</code> on every variable it defines.</p>
<p>Similarly, any subroutine that declares a pointer variable must allocate it and any data it points to before passing it to other subroutines or functions. If no specific length is known for an array pointer then it should be allocated to zero size. Any subsequent subroutines are free to deallocate and reallocate if they need to change the size.</p>
<p>This means that every subroutine (except for allocate and deallocate routines) should contain matching <code>allocate()/deallocate</code>() and <code>my_type_allocate()/my_type_deallocate()</code> calls. </p>
</div></div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
PartMC 2.3.0 documentation generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.7</small></address>
</body>
</html>
