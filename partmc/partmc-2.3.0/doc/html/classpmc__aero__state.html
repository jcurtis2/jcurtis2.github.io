<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PartMC: pmc_aero_state Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PartMC
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="modulepmc__aero__state-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pmc_aero_state Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="structpmc__aero__state_1_1aero__state__t.html" title="The current collection of aerosol particles. ">aero_state_t</a> structure and assocated subroutines.  
 <a href="classpmc__aero__state.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current collection of aerosol particles.  <a href="structpmc__aero__state_1_1aero__state__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a578ecf845c165057602472ad9917fbb1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a578ecf845c165057602472ad9917fbb1">aero_state_allocate</a> (aero_state)</td></tr>
<tr class="memdesc:a578ecf845c165057602472ad9917fbb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates aerosol arrays.  <a href="#a578ecf845c165057602472ad9917fbb1">More...</a><br /></td></tr>
<tr class="separator:a578ecf845c165057602472ad9917fbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c32a7fa46e2a2dee9e7996c632f884c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a8c32a7fa46e2a2dee9e7996c632f884c">aero_state_deallocate</a> (aero_state)</td></tr>
<tr class="memdesc:a8c32a7fa46e2a2dee9e7996c632f884c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates a previously allocated aerosol.  <a href="#a8c32a7fa46e2a2dee9e7996c632f884c">More...</a><br /></td></tr>
<tr class="separator:a8c32a7fa46e2a2dee9e7996c632f884c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87fcb6599b17bc1141d18d815b4b2e5b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a87fcb6599b17bc1141d18d815b4b2e5b">aero_state_reset</a> (aero_state)</td></tr>
<tr class="memdesc:a87fcb6599b17bc1141d18d815b4b2e5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets an <code>aero_state</code> to an empty state.  <a href="#a87fcb6599b17bc1141d18d815b4b2e5b">More...</a><br /></td></tr>
<tr class="separator:a87fcb6599b17bc1141d18d815b4b2e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de8fe5edb9e91f833f32cb992430451"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a8de8fe5edb9e91f833f32cb992430451">aero_state_copy</a> (aero_state_from, aero_state_to)</td></tr>
<tr class="memdesc:a8de8fe5edb9e91f833f32cb992430451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies aerosol to a destination that has already had <a class="el" href="classpmc__aero__state.html#a578ecf845c165057602472ad9917fbb1" title="Allocates aerosol arrays. ">aero_state_allocate()</a> called on it.  <a href="#a8de8fe5edb9e91f833f32cb992430451">More...</a><br /></td></tr>
<tr class="separator:a8de8fe5edb9e91f833f32cb992430451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade0790e3c1fbf87ed303a8ab22de32e3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ade0790e3c1fbf87ed303a8ab22de32e3">aero_state_copy_weight</a> (aero_state_from, aero_state_to)</td></tr>
<tr class="memdesc:ade0790e3c1fbf87ed303a8ab22de32e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies weighting information for an <code>aero_state</code>.  <a href="#ade0790e3c1fbf87ed303a8ab22de32e3">More...</a><br /></td></tr>
<tr class="separator:ade0790e3c1fbf87ed303a8ab22de32e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae949175272a73f61c851a2ac4a58c712"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ae949175272a73f61c851a2ac4a58c712">aero_state_set_weight</a> (aero_state, aero_data, weight_type, exponent)</td></tr>
<tr class="memdesc:ae949175272a73f61c851a2ac4a58c712"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the weighting functions for an <code>aero_state</code>.  <a href="#ae949175272a73f61c851a2ac4a58c712">More...</a><br /></td></tr>
<tr class="separator:ae949175272a73f61c851a2ac4a58c712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d688a836cb8ed88c46dd010247d3c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a82d688a836cb8ed88c46dd010247d3c1">aero_state_set_n_part_ideal</a> (aero_state, n_part)</td></tr>
<tr class="memdesc:a82d688a836cb8ed88c46dd010247d3c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the ideal number of particles to the given value. The <code>aero_state%awa</code> must be already set correctly.  <a href="#a82d688a836cb8ed88c46dd010247d3c1">More...</a><br /></td></tr>
<tr class="separator:a82d688a836cb8ed88c46dd010247d3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a070d20781c622419c7823654680595b4"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a070d20781c622419c7823654680595b4">aero_state_weight_class_for_source</a> (aero_state, source)</td></tr>
<tr class="memdesc:a070d20781c622419c7823654680595b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the appropriate weight class for a source.  <a href="#a070d20781c622419c7823654680595b4">More...</a><br /></td></tr>
<tr class="separator:a070d20781c622419c7823654680595b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bfa000bf19e64be5f1cf5aeebabe535"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a9bfa000bf19e64be5f1cf5aeebabe535">aero_state_total_particles</a> (aero_state, i_group, i_class)</td></tr>
<tr class="memdesc:a9bfa000bf19e64be5f1cf5aeebabe535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of particles in an aerosol distribution.  <a href="#a9bfa000bf19e64be5f1cf5aeebabe535">More...</a><br /></td></tr>
<tr class="separator:a9bfa000bf19e64be5f1cf5aeebabe535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38cf96ea2f1a3ee938bda68e93975cae"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a38cf96ea2f1a3ee938bda68e93975cae">aero_state_total_particles_all_procs</a> (aero_state, i_group, i_class)</td></tr>
<tr class="memdesc:a38cf96ea2f1a3ee938bda68e93975cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of particles across all processes.  <a href="#a38cf96ea2f1a3ee938bda68e93975cae">More...</a><br /></td></tr>
<tr class="separator:a38cf96ea2f1a3ee938bda68e93975cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748f903f70f90956fc02765c46f5e541"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a748f903f70f90956fc02765c46f5e541">aero_state_zero</a> (aero_state)</td></tr>
<tr class="memdesc:a748f903f70f90956fc02765c46f5e541"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets an aero_state to have zero particles per bin. This must already have had <a class="el" href="classpmc__aero__state.html#a578ecf845c165057602472ad9917fbb1" title="Allocates aerosol arrays. ">aero_state_allocate()</a> called on it. This function can be called more than once on the same state.  <a href="#a748f903f70f90956fc02765c46f5e541">More...</a><br /></td></tr>
<tr class="separator:a748f903f70f90956fc02765c46f5e541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b39c326b4702d2a3d90dcfe6e89407"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a75b39c326b4702d2a3d90dcfe6e89407">aero_state_add_particle</a> (aero_state, aero_particle, allow_resort)</td></tr>
<tr class="memdesc:a75b39c326b4702d2a3d90dcfe6e89407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the given particle.  <a href="#a75b39c326b4702d2a3d90dcfe6e89407">More...</a><br /></td></tr>
<tr class="separator:a75b39c326b4702d2a3d90dcfe6e89407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87d926e9b2ca5930053d449d771efcee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a87d926e9b2ca5930053d449d771efcee">aero_state_remove_particle_no_info</a> (aero_state, i_part)</td></tr>
<tr class="memdesc:a87d926e9b2ca5930053d449d771efcee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given particle without recording it.  <a href="#a87d926e9b2ca5930053d449d771efcee">More...</a><br /></td></tr>
<tr class="separator:a87d926e9b2ca5930053d449d771efcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad28b72502e5bb9caa40eac383d9bb22e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ad28b72502e5bb9caa40eac383d9bb22e">aero_state_remove_particle_with_info</a> (aero_state, i_part, aero_info)</td></tr>
<tr class="memdesc:ad28b72502e5bb9caa40eac383d9bb22e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given particle and record the removal.  <a href="#ad28b72502e5bb9caa40eac383d9bb22e">More...</a><br /></td></tr>
<tr class="separator:ad28b72502e5bb9caa40eac383d9bb22e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6">aero_state_remove_particle</a> (aero_state, i_part, record_removal, aero_info)</td></tr>
<tr class="memdesc:ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given particle and possibly record the removal.  <a href="#ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6">More...</a><br /></td></tr>
<tr class="separator:ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabf1b375475462cc54740039ad556a83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#aabf1b375475462cc54740039ad556a83">aero_state_remove_rand_particle_from_bin</a> (aero_state, i_bin, i_class, aero_particle)</td></tr>
<tr class="memdesc:aabf1b375475462cc54740039ad556a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a randomly chosen particle from the given bin and return it.  <a href="#aabf1b375475462cc54740039ad556a83">More...</a><br /></td></tr>
<tr class="separator:aabf1b375475462cc54740039ad556a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772c3ca6b3b34540cfe5ff509614a6e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a772c3ca6b3b34540cfe5ff509614a6e4">aero_state_dup_particle</a> (aero_state, i_part, n_part_mean, random_weight_group)</td></tr>
<tr class="memdesc:a772c3ca6b3b34540cfe5ff509614a6e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add copies or remove a particle, with a given mean number of resulting particles.  <a href="#a772c3ca6b3b34540cfe5ff509614a6e4">More...</a><br /></td></tr>
<tr class="separator:a772c3ca6b3b34540cfe5ff509614a6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc72ef956127f3ed9c8de449acd94a5a"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#acc72ef956127f3ed9c8de449acd94a5a">aero_state_particle_num_conc</a> (aero_state, aero_particle)</td></tr>
<tr class="memdesc:acc72ef956127f3ed9c8de449acd94a5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number concentration of a single particle (m^{-3}).  <a href="#acc72ef956127f3ed9c8de449acd94a5a">More...</a><br /></td></tr>
<tr class="separator:acc72ef956127f3ed9c8de449acd94a5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc7ed4ffdba12f2a7bb119875b1f132a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#abc7ed4ffdba12f2a7bb119875b1f132a">aero_state_num_conc_for_reweight</a> (aero_state, reweight_num_conc)</td></tr>
<tr class="memdesc:abc7ed4ffdba12f2a7bb119875b1f132a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the correct number concentrations for later use by <a class="el" href="classpmc__aero__state.html#ace9d0d11f278edc44c2d0cc1d641430f" title="Reweight all particles after their constituent volumes have been altered. ">aero_state_reweight()</a>.  <a href="#abc7ed4ffdba12f2a7bb119875b1f132a">More...</a><br /></td></tr>
<tr class="separator:abc7ed4ffdba12f2a7bb119875b1f132a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9d0d11f278edc44c2d0cc1d641430f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ace9d0d11f278edc44c2d0cc1d641430f">aero_state_reweight</a> (aero_state, reweight_num_conc)</td></tr>
<tr class="memdesc:ace9d0d11f278edc44c2d0cc1d641430f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reweight all particles after their constituent volumes have been altered.  <a href="#ace9d0d11f278edc44c2d0cc1d641430f">More...</a><br /></td></tr>
<tr class="separator:ace9d0d11f278edc44c2d0cc1d641430f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74bef1922136a43fbb3a8025c111e6a0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a74bef1922136a43fbb3a8025c111e6a0">aero_state_add</a> (aero_state, aero_state_delta)</td></tr>
<tr class="memdesc:a74bef1922136a43fbb3a8025c111e6a0"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>aero_state += aero_state_delta</code>, including combining the weights, so the new concentration is the weighted average of the two concentrations.  <a href="#a74bef1922136a43fbb3a8025c111e6a0">More...</a><br /></td></tr>
<tr class="separator:a74bef1922136a43fbb3a8025c111e6a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab09a1b5ebca16305e0db0754a39a6a7a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ab09a1b5ebca16305e0db0754a39a6a7a">aero_state_add_particles</a> (aero_state, aero_state_delta)</td></tr>
<tr class="memdesc:ab09a1b5ebca16305e0db0754a39a6a7a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>aero_state += aero_state_delta</code>, with the weight of <code>aero_state</code> left unchanged, so the new concentration is the sum of the two concentrations, computed with <code>aero_state%awa</code>.  <a href="#ab09a1b5ebca16305e0db0754a39a6a7a">More...</a><br /></td></tr>
<tr class="separator:ab09a1b5ebca16305e0db0754a39a6a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054ed7b319a465ad4a49661d4300acd4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a054ed7b319a465ad4a49661d4300acd4">aero_state_prepare_weight_for_add</a> (aero_state, i_group, i_class, n_add, allow_doubling, allow_halving)</td></tr>
<tr class="memdesc:a054ed7b319a465ad4a49661d4300acd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the weight if necessary to ensure that the addition of about <code>n_add</code> computational particles will give the correct final particle number.  <a href="#a054ed7b319a465ad4a49661d4300acd4">More...</a><br /></td></tr>
<tr class="separator:a054ed7b319a465ad4a49661d4300acd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28368fd18fc170709b6809de1930037d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a28368fd18fc170709b6809de1930037d">aero_state_add_aero_dist_sample</a> (aero_state, aero_data, aero_dist, sample_prop, create_time, allow_doubling, allow_halving, n_part_add)</td></tr>
<tr class="memdesc:a28368fd18fc170709b6809de1930037d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a Poisson sample of an <code>aero_dist</code>, adding to <code>aero_state</code>, with the given sample proportion.  <a href="#a28368fd18fc170709b6809de1930037d">More...</a><br /></td></tr>
<tr class="separator:a28368fd18fc170709b6809de1930037d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4369f9cfc8e1fdc80c6cd2aced773c9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ab4369f9cfc8e1fdc80c6cd2aced773c9">aero_state_rand_particle</a> (aero_state, i_part)</td></tr>
<tr class="memdesc:ab4369f9cfc8e1fdc80c6cd2aced773c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose a random particle from the aero_state.  <a href="#ab4369f9cfc8e1fdc80c6cd2aced773c9">More...</a><br /></td></tr>
<tr class="separator:ab4369f9cfc8e1fdc80c6cd2aced773c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61d3aad8a32ffc5732b0c854a1425e2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ae61d3aad8a32ffc5732b0c854a1425e2">aero_state_sample_particles</a> (aero_state_from, aero_state_to, sample_prob, removal_action)</td></tr>
<tr class="memdesc:ae61d3aad8a32ffc5732b0c854a1425e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random sample by removing particles from aero_state_from and adding them to aero_state_to, which must be already allocated (and should have its weight set).  <a href="#ae61d3aad8a32ffc5732b0c854a1425e2">More...</a><br /></td></tr>
<tr class="separator:ae61d3aad8a32ffc5732b0c854a1425e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d55fa54184d1fb06f00dc4c101a0915"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a7d55fa54184d1fb06f00dc4c101a0915">aero_state_sample</a> (aero_state_from, aero_state_to, sample_prob, removal_action)</td></tr>
<tr class="memdesc:a7d55fa54184d1fb06f00dc4c101a0915"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random sample by removing particles from aero_state_from and adding them to aero_state_to, transfering weight as well. This is the equivalent of <a class="el" href="classpmc__aero__state.html#a74bef1922136a43fbb3a8025c111e6a0" title="aero_state += aero_state_delta, including combining the weights, so the new concentration is the weig...">aero_state_add()</a>.  <a href="#a7d55fa54184d1fb06f00dc4c101a0915">More...</a><br /></td></tr>
<tr class="separator:a7d55fa54184d1fb06f00dc4c101a0915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5535ba7076130a468b1b71a36b64e408"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a5535ba7076130a468b1b71a36b64e408">aero_state_to_binned</a> (bin_grid, aero_data, aero_state, aero_binned)</td></tr>
<tr class="memdesc:a5535ba7076130a468b1b71a36b64e408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create binned number and mass arrays.  <a href="#a5535ba7076130a468b1b71a36b64e408">More...</a><br /></td></tr>
<tr class="separator:a5535ba7076130a468b1b71a36b64e408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae1bf6eb617f51c89ff0ce65327a22e"><td class="memItemLeft" align="right" valign="top">integer function, dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#adae1bf6eb617f51c89ff0ce65327a22e">aero_state_ids</a> (aero_state)</td></tr>
<tr class="memdesc:adae1bf6eb617f51c89ff0ce65327a22e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the IDs of all particles.  <a href="#adae1bf6eb617f51c89ff0ce65327a22e">More...</a><br /></td></tr>
<tr class="separator:adae1bf6eb617f51c89ff0ce65327a22e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3c630d6d65abdf818c560b3bf325e7"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#aeb3c630d6d65abdf818c560b3bf325e7">aero_state_diameters</a> (aero_state)</td></tr>
<tr class="memdesc:aeb3c630d6d65abdf818c560b3bf325e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the diameters of all particles.  <a href="#aeb3c630d6d65abdf818c560b3bf325e7">More...</a><br /></td></tr>
<tr class="separator:aeb3c630d6d65abdf818c560b3bf325e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0763ea8a51e45d9a4e6de8c16aa3be"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a7e0763ea8a51e45d9a4e6de8c16aa3be">aero_state_dry_diameters</a> (aero_state, aero_data)</td></tr>
<tr class="memdesc:a7e0763ea8a51e45d9a4e6de8c16aa3be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the dry diameters of all particles.  <a href="#a7e0763ea8a51e45d9a4e6de8c16aa3be">More...</a><br /></td></tr>
<tr class="separator:a7e0763ea8a51e45d9a4e6de8c16aa3be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb93285d6f5e04e757f204b7743ae69e"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#aeb93285d6f5e04e757f204b7743ae69e">aero_state_masses</a> (aero_state, aero_data, include, exclude)</td></tr>
<tr class="memdesc:aeb93285d6f5e04e757f204b7743ae69e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the masses of all particles.  <a href="#aeb93285d6f5e04e757f204b7743ae69e">More...</a><br /></td></tr>
<tr class="separator:aeb93285d6f5e04e757f204b7743ae69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ea3031c8e1febf27756b884bde558d"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ae1ea3031c8e1febf27756b884bde558d">aero_state_num_concs</a> (aero_state)</td></tr>
<tr class="memdesc:ae1ea3031c8e1febf27756b884bde558d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number concentrations of all particles.  <a href="#ae1ea3031c8e1febf27756b884bde558d">More...</a><br /></td></tr>
<tr class="separator:ae1ea3031c8e1febf27756b884bde558d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e47cafc26eb935053f106f48b93536d"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a3e47cafc26eb935053f106f48b93536d">aero_state_total_num_conc</a> (aero_state)</td></tr>
<tr class="memdesc:a3e47cafc26eb935053f106f48b93536d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number concentration.  <a href="#a3e47cafc26eb935053f106f48b93536d">More...</a><br /></td></tr>
<tr class="separator:a3e47cafc26eb935053f106f48b93536d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbf769c9d944cc748741a27201f6a10"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a3bbf769c9d944cc748741a27201f6a10">aero_state_mass_entropies</a> (aero_state, aero_data, include, exclude, group)</td></tr>
<tr class="memdesc:a3bbf769c9d944cc748741a27201f6a10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the mass-entropies of all particles.  <a href="#a3bbf769c9d944cc748741a27201f6a10">More...</a><br /></td></tr>
<tr class="separator:a3bbf769c9d944cc748741a27201f6a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89a327255d034e125d7bf42e578d4cdb"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a89a327255d034e125d7bf42e578d4cdb">aero_state_approx_crit_rel_humids</a> (aero_state, aero_data, env_state)</td></tr>
<tr class="memdesc:a89a327255d034e125d7bf42e578d4cdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the approximate critical relative humidity for all particles (1).  <a href="#a89a327255d034e125d7bf42e578d4cdb">More...</a><br /></td></tr>
<tr class="separator:a89a327255d034e125d7bf42e578d4cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2383e72aa13f85a1d9934503221d29"><td class="memItemLeft" align="right" valign="top">real(kind=dp) function, <br class="typebreak" />
dimension(aero_state%apa%n_part)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#afe2383e72aa13f85a1d9934503221d29">aero_state_crit_rel_humids</a> (aero_state, aero_data, env_state)</td></tr>
<tr class="memdesc:afe2383e72aa13f85a1d9934503221d29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the critical relative humidity for all particles (1).  <a href="#afe2383e72aa13f85a1d9934503221d29">More...</a><br /></td></tr>
<tr class="separator:afe2383e72aa13f85a1d9934503221d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9618d3e95a4e97e71b154586a2c8bc25"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a9618d3e95a4e97e71b154586a2c8bc25">aero_state_to_binned_dry</a> (bin_grid, aero_data, aero_state, aero_binned)</td></tr>
<tr class="memdesc:a9618d3e95a4e97e71b154586a2c8bc25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the same thing as aero_state_to_bin() but based on dry radius.  <a href="#a9618d3e95a4e97e71b154586a2c8bc25">More...</a><br /></td></tr>
<tr class="separator:a9618d3e95a4e97e71b154586a2c8bc25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab32e7aced707144b422b509f9eec26"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a8ab32e7aced707144b422b509f9eec26">aero_state_double</a> (aero_state, i_group, i_class)</td></tr>
<tr class="memdesc:a8ab32e7aced707144b422b509f9eec26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Doubles number of particles in the given weight group.  <a href="#a8ab32e7aced707144b422b509f9eec26">More...</a><br /></td></tr>
<tr class="separator:a8ab32e7aced707144b422b509f9eec26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5109f61fd1f0631a218a410154da5c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ac5109f61fd1f0631a218a410154da5c1">aero_state_halve</a> (aero_state, i_group, i_class)</td></tr>
<tr class="memdesc:ac5109f61fd1f0631a218a410154da5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove approximately half of the particles in the given weight group.  <a href="#ac5109f61fd1f0631a218a410154da5c1">More...</a><br /></td></tr>
<tr class="separator:ac5109f61fd1f0631a218a410154da5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a76219c237126e75642b8b1b7bc36e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a35a76219c237126e75642b8b1b7bc36e">aero_state_rebalance</a> (aero_state, allow_doubling, allow_halving, initial_state_warning)</td></tr>
<tr class="memdesc:a35a76219c237126e75642b8b1b7bc36e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double or halve the particle population in each weight group to maintain close to <code>n_part_ideal</code> particles per process, allocated equally amongst the weight groups.  <a href="#a35a76219c237126e75642b8b1b7bc36e">More...</a><br /></td></tr>
<tr class="separator:a35a76219c237126e75642b8b1b7bc36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0797fc5f44946731378848a67ab3491"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#aa0797fc5f44946731378848a67ab3491">aero_state_scale_weight</a> (aero_state, i_group, i_class, weight_ratio, allow_doubling, allow_halving)</td></tr>
<tr class="memdesc:aa0797fc5f44946731378848a67ab3491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale the weighting of the given group/class by the given ratio, altering particle number as necessary to preserve the number concentration.  <a href="#aa0797fc5f44946731378848a67ab3491">More...</a><br /></td></tr>
<tr class="separator:aa0797fc5f44946731378848a67ab3491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c40aa98c11c8dfe6e662f2bbd8672e9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a3c40aa98c11c8dfe6e662f2bbd8672e9">aero_state_mix</a> (aero_state, del_t, mix_timescale, aero_data, specify_prob_transfer)</td></tr>
<tr class="memdesc:a3c40aa98c11c8dfe6e662f2bbd8672e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mix the aero_states between all processes. Currently uses a simple all-to-all diffusion.  <a href="#a3c40aa98c11c8dfe6e662f2bbd8672e9">More...</a><br /></td></tr>
<tr class="separator:a3c40aa98c11c8dfe6e662f2bbd8672e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae546d85939653c1b2c7d52121d5f2bc6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ae546d85939653c1b2c7d52121d5f2bc6">aero_state_mpi_alltoall</a> (send, recv)</td></tr>
<tr class="memdesc:ae546d85939653c1b2c7d52121d5f2bc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do an MPI all-to-all transfer of aerosol states.  <a href="#ae546d85939653c1b2c7d52121d5f2bc6">More...</a><br /></td></tr>
<tr class="separator:ae546d85939653c1b2c7d52121d5f2bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab056de58c6dda08da7f81ef695326c89"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#ab056de58c6dda08da7f81ef695326c89">aero_state_bin_average_comp</a> (aero_state, bin_grid, aero_data)</td></tr>
<tr class="memdesc:ab056de58c6dda08da7f81ef695326c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set each aerosol particle to have its original total volume, but species volume ratios given by the total species volume ratio within each bin. This preserves the (weighted) total species volume per bin as well as per-particle total volumes.  <a href="#ab056de58c6dda08da7f81ef695326c89">More...</a><br /></td></tr>
<tr class="separator:ab056de58c6dda08da7f81ef695326c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a54c3ceabc9c8f2bb878555a6b4c98a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a3a54c3ceabc9c8f2bb878555a6b4c98a">aero_state_bin_average_size</a> (aero_state, bin_grid, aero_data, bin_center, preserve_number)</td></tr>
<tr class="memdesc:a3a54c3ceabc9c8f2bb878555a6b4c98a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set each aerosol particle to have its original species ratios, but total volume given by the average volume of all particles within each bin.  <a href="#a3a54c3ceabc9c8f2bb878555a6b4c98a">More...</a><br /></td></tr>
<tr class="separator:a3a54c3ceabc9c8f2bb878555a6b4c98a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e64dc08790a4600076982a43fe76221"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a7e64dc08790a4600076982a43fe76221">aero_state_make_dry</a> (aero_state, aero_data)</td></tr>
<tr class="memdesc:a7e64dc08790a4600076982a43fe76221"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make all particles dry (water set to zero).  <a href="#a7e64dc08790a4600076982a43fe76221">More...</a><br /></td></tr>
<tr class="separator:a7e64dc08790a4600076982a43fe76221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f65a578f1f08ed22c56a96686743cfd"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a9f65a578f1f08ed22c56a96686743cfd">pmc_mpi_pack_size_aero_state</a> (val)</td></tr>
<tr class="memdesc:a9f65a578f1f08ed22c56a96686743cfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the number of bytes required to pack the given value.  <a href="#a9f65a578f1f08ed22c56a96686743cfd">More...</a><br /></td></tr>
<tr class="separator:a9f65a578f1f08ed22c56a96686743cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4123bbc6bc887c5d4b7a6feae25be534"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a4123bbc6bc887c5d4b7a6feae25be534">pmc_mpi_pack_aero_state</a> (buffer, position, val)</td></tr>
<tr class="memdesc:a4123bbc6bc887c5d4b7a6feae25be534"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs the given value into the buffer, advancing position.  <a href="#a4123bbc6bc887c5d4b7a6feae25be534">More...</a><br /></td></tr>
<tr class="separator:a4123bbc6bc887c5d4b7a6feae25be534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fbfce661ac4cf88b383e88a44e0a9b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a1fbfce661ac4cf88b383e88a44e0a9b6">pmc_mpi_unpack_aero_state</a> (buffer, position, val)</td></tr>
<tr class="memdesc:a1fbfce661ac4cf88b383e88a44e0a9b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpacks the given value from the buffer, advancing position.  <a href="#a1fbfce661ac4cf88b383e88a44e0a9b6">More...</a><br /></td></tr>
<tr class="separator:a1fbfce661ac4cf88b383e88a44e0a9b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7baff7e2654d8acbff7906c718303b53"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a7baff7e2654d8acbff7906c718303b53">aero_state_mpi_gather</a> (aero_state, aero_state_total)</td></tr>
<tr class="memdesc:a7baff7e2654d8acbff7906c718303b53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gathers data from all processes into one aero_state on process 0.  <a href="#a7baff7e2654d8acbff7906c718303b53">More...</a><br /></td></tr>
<tr class="separator:a7baff7e2654d8acbff7906c718303b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb748f0c0c6c37180e896af05acb1c19"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#acb748f0c0c6c37180e896af05acb1c19">aero_state_netcdf_dim_aero_particle</a> (aero_state, ncid, dimid_aero_particle)</td></tr>
<tr class="memdesc:acb748f0c0c6c37180e896af05acb1c19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the aero particle dimension to the given NetCDF file if it is not already present and in any case return the associated dimid.  <a href="#acb748f0c0c6c37180e896af05acb1c19">More...</a><br /></td></tr>
<tr class="separator:acb748f0c0c6c37180e896af05acb1c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d32f436e51ba2ff96838b47e2169585"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a7d32f436e51ba2ff96838b47e2169585">aero_state_netcdf_dim_aero_removed</a> (aero_state, ncid, dimid_aero_removed)</td></tr>
<tr class="memdesc:a7d32f436e51ba2ff96838b47e2169585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the aero removed dimension to the given NetCDF file if it is not already present and in any case return the associated dimid.  <a href="#a7d32f436e51ba2ff96838b47e2169585">More...</a><br /></td></tr>
<tr class="separator:a7d32f436e51ba2ff96838b47e2169585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2118eb683c0dc350e8f48a59ea8ed8ce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a2118eb683c0dc350e8f48a59ea8ed8ce">aero_state_input_netcdf</a> (aero_state, ncid, aero_data)</td></tr>
<tr class="memdesc:a2118eb683c0dc350e8f48a59ea8ed8ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read full state.  <a href="#a2118eb683c0dc350e8f48a59ea8ed8ce">More...</a><br /></td></tr>
<tr class="separator:a2118eb683c0dc350e8f48a59ea8ed8ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130922fd0c019dd985d9568dfe6f73f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a130922fd0c019dd985d9568dfe6f73f7">aero_state_sort</a> (aero_state, bin_grid, all_procs_same)</td></tr>
<tr class="memdesc:a130922fd0c019dd985d9568dfe6f73f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorts the particles if necessary.  <a href="#a130922fd0c019dd985d9568dfe6f73f7">More...</a><br /></td></tr>
<tr class="separator:a130922fd0c019dd985d9568dfe6f73f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d21c249c81e6b4a66bf545cc8c1d0a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a5d21c249c81e6b4a66bf545cc8c1d0a5">aero_state_check_sort</a> (aero_state)</td></tr>
<tr class="memdesc:a5d21c249c81e6b4a66bf545cc8c1d0a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that the sorted data is consistent.  <a href="#a5d21c249c81e6b4a66bf545cc8c1d0a5">More...</a><br /></td></tr>
<tr class="separator:a5d21c249c81e6b4a66bf545cc8c1d0a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a585d061ace6ecfefa6eaadeb8efbeb5d"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a585d061ace6ecfefa6eaadeb8efbeb5d">aero_state_tag_mix</a> = 4987</td></tr>
<tr class="memdesc:a585d061ace6ecfefa6eaadeb8efbeb5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI tag for mixing particles between processes.  <a href="#a585d061ace6ecfefa6eaadeb8efbeb5d">More...</a><br /></td></tr>
<tr class="separator:a585d061ace6ecfefa6eaadeb8efbeb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8016b38f6c38806de95b72ffaecbe212"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a8016b38f6c38806de95b72ffaecbe212">aero_state_tag_gather</a> = 4988</td></tr>
<tr class="memdesc:a8016b38f6c38806de95b72ffaecbe212"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI tag for gathering between processes.  <a href="#a8016b38f6c38806de95b72ffaecbe212">More...</a><br /></td></tr>
<tr class="separator:a8016b38f6c38806de95b72ffaecbe212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a81bec0174512abf54faf2673da5c3"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a47a81bec0174512abf54faf2673da5c3">aero_state_tag_scatter</a> = 4989</td></tr>
<tr class="memdesc:a47a81bec0174512abf54faf2673da5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI tag for scattering between processes.  <a href="#a47a81bec0174512abf54faf2673da5c3">More...</a><br /></td></tr>
<tr class="separator:a47a81bec0174512abf54faf2673da5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae976ee50ab7c0415628dd99a6feded"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#afae976ee50ab7c0415628dd99a6feded">aero_state_weight_none</a> = 1</td></tr>
<tr class="memdesc:afae976ee50ab7c0415628dd99a6feded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single flat weighting scheme.  <a href="#afae976ee50ab7c0415628dd99a6feded">More...</a><br /></td></tr>
<tr class="separator:afae976ee50ab7c0415628dd99a6feded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b0c9b3118a486936fe3c50c4d908f6"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a72b0c9b3118a486936fe3c50c4d908f6">aero_state_weight_flat</a> = 2</td></tr>
<tr class="memdesc:a72b0c9b3118a486936fe3c50c4d908f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single flat weighting scheme.  <a href="#a72b0c9b3118a486936fe3c50c4d908f6">More...</a><br /></td></tr>
<tr class="separator:a72b0c9b3118a486936fe3c50c4d908f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c80e8cba61697786d2302e44cd041bd"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a2c80e8cba61697786d2302e44cd041bd">aero_state_weight_power</a> = 3</td></tr>
<tr class="memdesc:a2c80e8cba61697786d2302e44cd041bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Power-law weighting scheme.  <a href="#a2c80e8cba61697786d2302e44cd041bd">More...</a><br /></td></tr>
<tr class="separator:a2c80e8cba61697786d2302e44cd041bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa014d0549b2455e245bef4959b781af3"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#aa014d0549b2455e245bef4959b781af3">aero_state_weight_nummass</a> = 4</td></tr>
<tr class="memdesc:aa014d0549b2455e245bef4959b781af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coupled number/mass weighting scheme.  <a href="#aa014d0549b2455e245bef4959b781af3">More...</a><br /></td></tr>
<tr class="separator:aa014d0549b2455e245bef4959b781af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af731fa16fa6f5f7dcb5dde7bc5118b5a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#af731fa16fa6f5f7dcb5dde7bc5118b5a">aero_state_weight_flat_source</a> = 5</td></tr>
<tr class="memdesc:af731fa16fa6f5f7dcb5dde7bc5118b5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flat weighting by source.  <a href="#af731fa16fa6f5f7dcb5dde7bc5118b5a">More...</a><br /></td></tr>
<tr class="separator:af731fa16fa6f5f7dcb5dde7bc5118b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496284ecee4a72a18a45e67f5c17e610"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a496284ecee4a72a18a45e67f5c17e610">aero_state_weight_power_source</a> = 6</td></tr>
<tr class="memdesc:a496284ecee4a72a18a45e67f5c17e610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Power-law weighting by source.  <a href="#a496284ecee4a72a18a45e67f5c17e610">More...</a><br /></td></tr>
<tr class="separator:a496284ecee4a72a18a45e67f5c17e610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b883c1a2ba3797a44ab2a4104c9d2a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpmc__aero__state.html#a22b883c1a2ba3797a44ab2a4104c9d2a">aero_state_weight_nummass_source</a> = 7</td></tr>
<tr class="memdesc:a22b883c1a2ba3797a44ab2a4104c9d2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coupled number/mass weighting by source.  <a href="#a22b883c1a2ba3797a44ab2a4104c9d2a">More...</a><br /></td></tr>
<tr class="separator:a22b883c1a2ba3797a44ab2a4104c9d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="structpmc__aero__state_1_1aero__state__t.html" title="The current collection of aerosol particles. ">aero_state_t</a> structure and assocated subroutines. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00009">9</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a74bef1922136a43fbb3a8025c111e6a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_add </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state_delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>aero_state += aero_state_delta</code>, including combining the weights, so the new concentration is the weighted average of the two concentrations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state_delta</td><td>Increment. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00611">611</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a28368fd18fc170709b6809de1930037d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_add_aero_dist_sample </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_dist_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>sample_prop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>create_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_doubling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_halving</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out), optional&#160;</td>
          <td class="paramname"><em>n_part_add</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a Poisson sample of an <code>aero_dist</code>, adding to <code>aero_state</code>, with the given sample proportion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aero state to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aero data values.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_dist</td><td>Distribution to sample.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_prop</td><td>Fraction to sample (1).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">create_time</td><td>Creation time for new particles (s).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_doubling</td><td>Whether to allow doubling of the population.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_halving</td><td>Whether to allow halving of the population.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n_part_add</td><td>Number of particles added. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00694">694</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a75b39c326b4702d2a3d90dcfe6e89407"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_add_particle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_particle_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>allow_resort</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the given particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_particle</td><td>Particle to add.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_resort</td><td>Whether to allow a resort due to the add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00330">330</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ab09a1b5ebca16305e0db0754a39a6a7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_add_particles </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state_delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>aero_state += aero_state_delta</code>, with the weight of <code>aero_state</code> left unchanged, so the new concentration is the sum of the two concentrations, computed with <code>aero_state%awa</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state_delta</td><td>Increment. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00628">628</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a578ecf845c165057602472ad9917fbb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_allocate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(out)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates aerosol arrays. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">aero_state</td><td>Aerosol to initialize. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00083">83</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a89a327255d034e125d7bf42e578d4cdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_approx_crit_rel_humids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(env_state_t), intent(in)&#160;</td>
          <td class="paramname"><em>env_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the approximate critical relative humidity for all particles (1). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env_state</td><td>Environment state. </td></tr>
  </table>
  </dd>
</dl>
<p>Return value. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01199">1199</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ab056de58c6dda08da7f81ef695326c89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_bin_average_comp </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bin_grid_t), intent(in)&#160;</td>
          <td class="paramname"><em>bin_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set each aerosol particle to have its original total volume, but species volume ratios given by the total species volume ratio within each bin. This preserves the (weighted) total species volume per bin as well as per-particle total volumes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state to average.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_grid</td><td>Bin grid to average within.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01644">1644</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a3a54c3ceabc9c8f2bb878555a6b4c98a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_bin_average_size </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bin_grid_t), intent(in)&#160;</td>
          <td class="paramname"><em>bin_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>bin_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>preserve_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set each aerosol particle to have its original species ratios, but total volume given by the average volume of all particles within each bin. </p>
<p>This does not preserve the total species volume per bin. If the <code>bin_center</code> parameter is <code></code>.true. then the particles in each bin are set to have the bin center volume, rather than the average volume of the particles in that bin.</p>
<p>If the weighting function is not constant (AERO_WEIGHT_TYPE_NONE) then the averaging can be performed in either a number-preserving way or in a volume-preserving way. The volume-preserving way does not preserve species volume ratios in gernal, but will do so if the particle population has already been composition-averaged.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state to average.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_grid</td><td>Bin grid to average within.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_center</td><td>Whether to assign the bin center volume (rather than the average volume).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">preserve_number</td><td>Whether to use the number-preserving scheme (otherwise will use the volume-preserving scheme). This parameter has no effect if <code>bin_center</code> is <code></code>.true. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01708">1708</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a5d21c249c81e6b4a66bf545cc8c1d0a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_check_sort </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that the sorted data is consistent. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state to check. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02723">2723</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a8de8fe5edb9e91f833f32cb992430451"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_copy </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies aerosol to a destination that has already had <a class="el" href="classpmc__aero__state.html#a578ecf845c165057602472ad9917fbb1" title="Allocates aerosol arrays. ">aero_state_allocate()</a> called on it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state_from</td><td>Reference aerosol.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_to</td><td>Already allocated. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00131">131</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ade0790e3c1fbf87ed303a8ab22de32e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_copy_weight </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies weighting information for an <code>aero_state</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state_from</td><td>Reference aerosol.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_to</td><td>Already allocated. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00150">150</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="afe2383e72aa13f85a1d9934503221d29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_crit_rel_humids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(env_state_t), intent(in)&#160;</td>
          <td class="paramname"><em>env_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the critical relative humidity for all particles (1). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env_state</td><td>Environment state. </td></tr>
  </table>
  </dd>
</dl>
<p>Return value. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01224">1224</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a8c32a7fa46e2a2dee9e7996c632f884c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_deallocate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates a previously allocated aerosol. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol to deallocate. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00100">100</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="aeb3c630d6d65abdf818c560b3bf325e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_diameters </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the diameters of all particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state. </td></tr>
  </table>
  </dd>
</dl>
<p>Return diameters array (m). </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00976">976</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a8ab32e7aced707144b422b509f9eec26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_double </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Doubles number of particles in the given weight group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group to double.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class to double. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01289">1289</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7e0763ea8a51e45d9a4e6de8c16aa3be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_dry_diameters </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the dry diameters of all particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data. </td></tr>
  </table>
  </dd>
</dl>
<p>Return value (m). </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00992">992</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a772c3ca6b3b34540cfe5ff509614a6e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_dup_particle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>n_part_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>random_weight_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add copies or remove a particle, with a given mean number of resulting particles. </p>
<p>The particle number <code>i_part</code> is either removed, or zero or more copies are added, with a random number of copies with the given mean <code>n_part_mean</code>. The final number of particles is either <code>floor(n_part_mean)</code> or <code>ceiling(n_part_mean)</code>, chosen randomly so the mean is <code>n_part_mean</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_part</td><td>Particle number.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_part_mean</td><td>Mean number of resulting particles.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">random_weight_group</td><td>Whether particle copies should be placed in a randomly chosen weight group. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00450">450</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ac5109f61fd1f0631a218a410154da5c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_halve </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove approximately half of the particles in the given weight group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group to halve.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class to halve. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01321">1321</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="adae1bf6eb617f51c89ff0ce65327a22e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_ids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the IDs of all particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state. </td></tr>
  </table>
  </dd>
</dl>
<p>Return value. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00957">957</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a2118eb683c0dc350e8f48a59ea8ed8ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_input_netcdf </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read full state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>aero_state to read.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>aero_data structure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02510">2510</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7e64dc08790a4600076982a43fe76221"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_make_dry </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make all particles dry (water set to zero). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state to make dry.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01900">1900</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a3bbf769c9d944cc748741a27201f6a10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_mass_entropies </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), optional&#160;</td>
          <td class="paramname"><em>include</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), optional&#160;</td>
          <td class="paramname"><em>exclude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), optional&#160;</td>
          <td class="paramname"><em>group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the mass-entropies of all particles. </p>
<p>If <code>include</code> is specified then only those species are included in computing the entropy. If <code>exclude</code> is specified then all species except those species are included. If both <code>include</code> and <code>exclude</code> arguments are specified then only those species in <code>include</code> but not in <code>exclude</code> are included. If <code>group</code> is specified then the species are divided into two sets, given by those in the group and those not in the group. The entropy is then computed using the total mass of each set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">include</td><td>Species names to include in the mass.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">exclude</td><td>Species names to exclude in the mass.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">group</td><td>Species names to group together. </td></tr>
  </table>
  </dd>
</dl>
<p>Return value. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01121">1121</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="aeb93285d6f5e04e757f204b7743ae69e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_masses </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), optional&#160;</td>
          <td class="paramname"><em>include</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), dimension(:), optional&#160;</td>
          <td class="paramname"><em>exclude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the masses of all particles. </p>
<p>If <code>include</code> is specified then only those species are included in computing the masses. If <code>exclude</code> is specified then all species except those species are included. If both <code>include</code> and <code>exclude</code> arguments are specified then only those species in <code>include</code> but not in <code>exclude</code> are included.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">include</td><td>Species names to include in the mass.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">exclude</td><td>Species names to exclude in the mass. </td></tr>
  </table>
  </dd>
</dl>
<p>Return masses array (kg). </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01016">1016</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a3c40aa98c11c8dfe6e662f2bbd8672e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_mix </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>del_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>mix_timescale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>specify_prob_transfer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mix the aero_states between all processes. Currently uses a simple all-to-all diffusion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del_t</td><td>Timestep (s).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mix_timescale</td><td>Mixing timescale (s).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aero data values.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">specify_prob_transfer</td><td>Transfer probability of each particle (0 means no mixing, 1 means total mixing). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01483">1483</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ae546d85939653c1b2c7d52121d5f2bc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_mpi_alltoall </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>send</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), dimension(size(send)), intent(inout)&#160;</td>
          <td class="paramname"><em>recv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do an MPI all-to-all transfer of aerosol states. </p>
<p>States without particles are not sent.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">send</td><td>Array of aero_states to send (one per process).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">recv</td><td>Array of aero_states to receives (one per process). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01575">1575</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7baff7e2654d8acbff7906c718303b53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_mpi_gather </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_total</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gathers data from all processes into one aero_state on process 0. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Local aero_state.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_total</td><td>Centralized aero_state (only on process 0). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02000">2000</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="acb748f0c0c6c37180e896af05acb1c19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_netcdf_dim_aero_particle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>dimid_aero_particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the aero particle dimension to the given NetCDF file if it is not already present and in any case return the associated dimid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>aero_state structure.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dimid_aero_particle</td><td>Dimid of the aero particle dimension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02073">2073</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7d32f436e51ba2ff96838b47e2169585"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_netcdf_dim_aero_removed </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>dimid_aero_removed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the aero removed dimension to the given NetCDF file if it is not already present and in any case return the associated dimid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>aero_state structure.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID, in data mode.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dimid_aero_removed</td><td>Dimid of the aero removed dimension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02114">2114</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="abc7ed4ffdba12f2a7bb119875b1f132a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_num_conc_for_reweight </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(aero_state%apa%n_part), intent(out)&#160;</td>
          <td class="paramname"><em>reweight_num_conc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the correct number concentrations for later use by <a class="el" href="classpmc__aero__state.html#ace9d0d11f278edc44c2d0cc1d641430f" title="Reweight all particles after their constituent volumes have been altered. ">aero_state_reweight()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">reweight_num_conc</td><td>Number concentrations for later use by <a class="el" href="classpmc__aero__state.html#ace9d0d11f278edc44c2d0cc1d641430f" title="Reweight all particles after their constituent volumes have been altered. ">aero_state_reweight()</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00522">522</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ae1ea3031c8e1febf27756b884bde558d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function, dimension(aero_state%apa%n_part) pmc_aero_state::aero_state_num_concs </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number concentrations of all particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state. </td></tr>
  </table>
  </dd>
</dl>
<p>Return number concentrations array (m^{-3}). </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01072">1072</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="acc72ef956127f3ed9c8de449acd94a5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function pmc_aero_state::aero_state_particle_num_conc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_particle_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The number concentration of a single particle (m^{-3}). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state containing the particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_particle</td><td>Aerosol particle. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00505">505</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a054ed7b319a465ad4a49661d4300acd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_prepare_weight_for_add </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>n_add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_doubling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_halving</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the weight if necessary to ensure that the addition of about <code>n_add</code> computational particles will give the correct final particle number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aero state to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group number to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class number to add to.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_add</td><td>Approximate number of particles to be added at current weighting.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_doubling</td><td>Whether to allow doubling of the population.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_halving</td><td>Whether to allow halving of the population. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00651">651</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ab4369f9cfc8e1fdc80c6cd2aced773c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_rand_particle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>i_part</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Choose a random particle from the aero_state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Original state.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">i_part</td><td>Chosen random particle number. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00771">771</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a35a76219c237126e75642b8b1b7bc36e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_rebalance </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_doubling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_halving</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>initial_state_warning</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double or halve the particle population in each weight group to maintain close to <code>n_part_ideal</code> particles per process, allocated equally amongst the weight groups. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_doubling</td><td>Whether to allow doubling of the population.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_halving</td><td>Whether to allow halving of the population.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">initial_state_warning</td><td>Whether to warn due to initial state doubling/halving. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01356">1356</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_remove_particle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>record_removal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_info_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the given particle and possibly record the removal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_part</td><td>Index of particle to remove.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">record_removal</td><td>Whether to record the removal in the aero_info_array.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_info</td><td>Removal info. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00389">389</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a87d926e9b2ca5930053d449d771efcee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_remove_particle_no_info </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_part</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the given particle without recording it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_part</td><td>Index of particle to remove. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00351">351</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ad28b72502e5bb9caa40eac383d9bb22e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_remove_particle_with_info </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_info_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the given particle and record the removal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_part</td><td>Index of particle to remove.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_info</td><td>Removal info. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00370">370</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="aabf1b375475462cc54740039ad556a83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_remove_rand_particle_from_bin </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_particle_t), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a randomly chosen particle from the given bin and return it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_bin</td><td>Bin number to remove particle from.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class to remove particle from.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_particle</td><td>Removed particle. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00414">414</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a87fcb6599b17bc1141d18d815b4b2e5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_reset </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets an <code>aero_state</code> to an empty state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol to reset. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00117">117</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ace9d0d11f278edc44c2d0cc1d641430f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_reweight </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(aero_state%apa%n_part), intent(in)&#160;</td>
          <td class="paramname"><em>reweight_num_conc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reweight all particles after their constituent volumes have been altered. </p>
<p>The pattern for use should be like: </p><pre>
 call aero_state_num_conc_for_reweight(aero_state, reweight_num_conc)
 ... alter particle species volumes in aero_state ...
 call aero_state_reweight(aero_state, reweight_num_conc)
 </pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reweight_num_conc</td><td>Number concentrations previously computed by <a class="el" href="classpmc__aero__state.html#abc7ed4ffdba12f2a7bb119875b1f132a" title="Save the correct number concentrations for later use by aero_state_reweight(). ">aero_state_num_conc_for_reweight()</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00550">550</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a7d55fa54184d1fb06f00dc4c101a0915"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_sample </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>sample_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>removal_action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a random sample by removing particles from aero_state_from and adding them to aero_state_to, transfering weight as well. This is the equivalent of <a class="el" href="classpmc__aero__state.html#a74bef1922136a43fbb3a8025c111e6a0" title="aero_state += aero_state_delta, including combining the weights, so the new concentration is the weig...">aero_state_add()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_from</td><td>Original state.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_to</td><td>Destination state (previous contents will be lost).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_prob</td><td>Probability of sampling each particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">removal_action</td><td>Action for removal (see <a class="el" href="classpmc__aero__info.html" title="The aero_info_t structure and associated subroutines. ">pmc_aero_info</a> module for action parameters). Set to AERO_INFO_NONE to not log removal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00866">866</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ae61d3aad8a32ffc5732b0c854a1425e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_sample_particles </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>sample_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>removal_action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a random sample by removing particles from aero_state_from and adding them to aero_state_to, which must be already allocated (and should have its weight set). </p>
<p>None of the weights are altered by this sampling, making this the equivalent of <a class="el" href="classpmc__aero__state.html#ab09a1b5ebca16305e0db0754a39a6a7a" title="aero_state += aero_state_delta, with the weight of aero_state left unchanged, so the new concentratio...">aero_state_add_particles()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_from</td><td>Original state.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state_to</td><td>Destination state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sample_prob</td><td>Probability of sampling each particle.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">removal_action</td><td>Action for removal (see <a class="el" href="classpmc__aero__info.html" title="The aero_info_t structure and associated subroutines. ">pmc_aero_info</a> module for action parameters). Set to AERO_INFO_NONE to not log removal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00791">791</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="aa0797fc5f44946731378848a67ab3491"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_scale_weight </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>weight_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_doubling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>allow_halving</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scale the weighting of the given group/class by the given ratio, altering particle number as necessary to preserve the number concentration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group number.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class number.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weight_ratio</td><td>Ratio of <code>new_weight / old_weight</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_doubling</td><td>Whether to allow doubling of the population.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allow_halving</td><td>Whether to allow halving of the population. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01421">1421</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a82d688a836cb8ed88c46dd010247d3c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_set_n_part_ideal </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in)&#160;</td>
          <td class="paramname"><em>n_part</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the ideal number of particles to the given value. The <code>aero_state%awa</code> must be already set correctly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state (with <code>aero_state%awa</code> set).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_part</td><td>Ideal total number of particles. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00211">211</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="ae949175272a73f61c851a2ac4a58c712"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_set_weight </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>weight_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>exponent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the weighting functions for an <code>aero_state</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol to set the weights on.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weight_type</td><td>Type of weighting scheme to use.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exponent</td><td>Exponent for power-law weighting (only used if <code>weight_type</code> is <code>AERO_STATE_WEIGHT_POWER</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00164">164</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a130922fd0c019dd985d9568dfe6f73f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_sort </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bin_grid_t), intent(in), optional&#160;</td>
          <td class="paramname"><em>bin_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>all_procs_same</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sorts the particles if necessary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>Aerosol state to sort.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_grid</td><td>Bin grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">all_procs_same</td><td>Whether all processors should use the same bin grid. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l02704">2704</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a5535ba7076130a468b1b71a36b64e408"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_to_binned </td>
          <td>(</td>
          <td class="paramtype">type(bin_grid_t), intent(in)&#160;</td>
          <td class="paramname"><em>bin_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_binned_t), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_binned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create binned number and mass arrays. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_grid</td><td>Bin grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_binned</td><td>Binned distributions. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00917">917</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a9618d3e95a4e97e71b154586a2c8bc25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_to_binned_dry </td>
          <td>(</td>
          <td class="paramtype">type(bin_grid_t), intent(in)&#160;</td>
          <td class="paramname"><em>bin_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_data_t), intent(in)&#160;</td>
          <td class="paramname"><em>aero_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(aero_binned_t), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_binned</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the same thing as aero_state_to_bin() but based on dry radius. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bin_grid</td><td>Bin grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_data</td><td>Aerosol data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_binned</td><td>Binned distributions. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01248">1248</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a3e47cafc26eb935053f106f48b93536d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=dp) function pmc_aero_state::aero_state_total_num_conc </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total number concentration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01093">1093</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a9bfa000bf19e64be5f1cf5aeebabe535"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function pmc_aero_state::aero_state_total_particles </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>i_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total number of particles in an aerosol distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00255">255</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a38cf96ea2f1a3ee938bda68e93975cae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function pmc_aero_state::aero_state_total_particles_all_procs </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>i_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>i_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total number of particles across all processes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_group</td><td>Weight group.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_class</td><td>Weight class. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00293">293</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a070d20781c622419c7823654680595b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function pmc_aero_state::aero_state_weight_class_for_source </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>aero_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the appropriate weight class for a source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aero_state</td><td>Aerosol state.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">source</td><td>Source to find the class for. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00231">231</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a748f903f70f90956fc02765c46f5e541"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::aero_state_zero </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>aero_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets an aero_state to have zero particles per bin. This must already have had <a class="el" href="classpmc__aero__state.html#a578ecf845c165057602472ad9917fbb1" title="Allocates aerosol arrays. ">aero_state_allocate()</a> called on it. This function can be called more than once on the same state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aero_state</td><td>State to zero. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00314">314</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a4123bbc6bc887c5d4b7a6feae25be534"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::pmc_mpi_pack_aero_state </td>
          <td>(</td>
          <td class="paramtype">character, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Packs the given value into the buffer, advancing position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buffer</td><td>Memory buffer.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">position</td><td>Current buffer position.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Value to pack. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01947">1947</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a9f65a578f1f08ed22c56a96686743cfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function pmc_aero_state::pmc_mpi_pack_size_aero_state </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(in)&#160;</td>
          <td class="paramname"><em>val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the number of bytes required to pack the given value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Value to pack. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01928">1928</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a1fbfce661ac4cf88b383e88a44e0a9b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pmc_aero_state::pmc_mpi_unpack_aero_state </td>
          <td>(</td>
          <td class="paramtype">character, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structpmc__aero__state_1_1aero__state__t.html">aero_state_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpacks the given value from the buffer, advancing position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buffer</td><td>Memory buffer.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">position</td><td>Current buffer position.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>Value to pack. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l01973">1973</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8016b38f6c38806de95b72ffaecbe212"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_tag_gather = 4988</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MPI tag for gathering between processes. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00034">34</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a585d061ace6ecfefa6eaadeb8efbeb5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_tag_mix = 4987</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MPI tag for mixing particles between processes. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00032">32</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a47a81bec0174512abf54faf2673da5c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_tag_scatter = 4989</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MPI tag for scattering between processes. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00036">36</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a72b0c9b3118a486936fe3c50c4d908f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_flat = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single flat weighting scheme. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00041">41</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="af731fa16fa6f5f7dcb5dde7bc5118b5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_flat_source = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flat weighting by source. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00047">47</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="afae976ee50ab7c0415628dd99a6feded"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_none = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single flat weighting scheme. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00039">39</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="aa014d0549b2455e245bef4959b781af3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_nummass = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coupled number/mass weighting scheme. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00045">45</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a22b883c1a2ba3797a44ab2a4104c9d2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_nummass_source = 7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coupled number/mass weighting by source. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00051">51</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a2c80e8cba61697786d2302e44cd041bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_power = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Power-law weighting scheme. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00043">43</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<a class="anchor" id="a496284ecee4a72a18a45e67f5c17e610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter pmc_aero_state::aero_state_weight_power_source = 6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Power-law weighting by source. </p>

<p>Definition at line <a class="el" href="aero__state_8_f90_source.html#l00049">49</a> of file <a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a>.</p>

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li><a class="el" href="aero__state_8_f90_source.html">aero_state.F90</a></li>
</ul>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
PartMC 2.3.0 documentation generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.7</small></address>
</body>
</html>
